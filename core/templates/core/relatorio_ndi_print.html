{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Relatório NDI - {{ turma.nome }}</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* CSS OTIMIZADO PARA IMPRESSÃO A4 */
        :root {
            --cor-primaria: {{ configuracao.cor_primaria|default:"#14452F" }};
            --cor-secundaria: {{ configuracao.cor_secundaria|default:"#D4AF37" }};
        }

        body { font-family: 'Plus Jakarta Sans', sans-serif; font-size: 12px; color: #333; -webkit-print-color-adjust: exact; }
        
        .header { text-align: center; margin-bottom: 20px; border-bottom: 3px solid var(--cor-secundaria); padding-bottom: 10px; }
        .header h1 { margin: 0; color: var(--cor-primaria); text-transform: uppercase; font-size: 18px; }
        .header p { margin: 2px 0; color: #666; }
        
        .info-box { display: flex; justify-content: space-between; margin-bottom: 15px; background: #f8f9fa; padding: 10px; border-radius: 4px; border-left: 5px solid var(--cor-primaria); }
        .info-item strong { color: var(--cor-primaria); }
        
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th, td { padding: 8px 5px; border: 1px solid #ddd; text-align: center; }
        
        thead th { background-color: var(--cor-primaria); color: white; font-weight: 600; }
        .th-sec { background-color: #f3f4f6; color: #333; font-size: 10px; text-transform: uppercase; }
        
        .col-aluno { text-align: left; padding-left: 10px; font-weight: 600; width: 30%; }
        .col-destaque { background-color: rgba(212, 175, 55, 0.1); font-weight: bold; }
        .col-final { background-color: rgba(20, 69, 47, 0.1); font-weight: bold; color: var(--cor-primaria); }
        
        .status-aprovado { color: green; font-weight: bold; }
        .status-recuperacao { color: orange; font-weight: bold; }
        .status-reprovado { color: red; font-weight: bold; }

        .footer { position: fixed; bottom: 0; left: 0; right: 0; text-align: center; font-size: 9px; color: #999; border-top: 1px solid #eee; padding-top: 5px; }

        @media print {
            body { margin: 0; padding: 10px; }
            .no-print { display: none; }
            @page { margin: 1cm; size: A4 portrait; }
        }
    </style>
</head>
<body onload="window.print()">

    <div class="header">
        <h1>{{ configuracao.nome_escola|default:"Escola EEMTI" }}</h1>
        <p>Relatório de Desempenho Acadêmico - NDI</p>
    </div>

    <div class="info-box">
        <div class="info-item">TURMA: <strong>{{ turma.nome }}</strong></div>
        <div class="info-item">PERÍODO: <strong>{{ bimestre }}º BIMESTRE</strong></div>
        <div class="info-item">ANO: <strong>2026</strong></div>
        <div class="info-item">GERADO EM: {{ data_geracao|date:"d/m/Y H:i" }}</div>
    </div>

    <table>
        <thead>
            <tr>
                <th rowspan="2">ALUNO</th>
                <th colspan="4">AVALIAÇÃO CONTÍNUA</th>
                <th colspan="2">PROVAS</th>
                <th rowspan="2" style="background-color: var(--cor-secundaria); color: #000;">MÉDIA FINAL</th>
                <th rowspan="2" style="background-color: #eee; color: #333;">SITUAÇÃO</th>
            </tr>
            <tr class="th-sec">
                <th>FREQ</th> <th>ATIV</th> <th>COMP</th> <th>PARCIAL</th>
                <th>P. PARCIAL</th> <th>P. BIMEST.</th>
            </tr>
        </thead>
        <tbody>
            {% for d in dados %}
            <tr>
                <td class="col-aluno">{{ d.aluno }}</td>
                <td>{{ d.notas.freq|floatformat:1 }}</td>
                <td>{{ d.notas.atv|floatformat:1 }}</td>
                <td>{{ d.notas.comp|floatformat:1 }}</td>
                <td class="col-destaque">{{ d.notas.parcial|floatformat:1 }}</td>
                <td>{{ d.notas.pp|floatformat:1 }}</td>
                <td>{{ d.notas.pb|floatformat:1 }}</td>
                <td class="col-final">{{ d.notas.final|floatformat:1 }}</td>
                <td>
                    {% if d.status == 'APROVADO' %}<span class="status-aprovado">APR</span>
                    {% elif d.status == 'RECUPERAÇÃO' %}<span class="status-recuperacao">REC</span>
                    {% else %}<span class="status-reprovado">REP</span>{% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="footer">
        Documento gerado pelo sistema SAMI - Sistema de Monitoramento Inteligente
    </div>

</body>
</html>